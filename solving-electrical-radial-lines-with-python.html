<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Michy's website</title>
	<meta name="description" content="">
	<meta name="author" content="Michy Alice">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="/theme/bootstrap.min.css" rel="stylesheet">
	<link href="/theme/local.css" rel="stylesheet">
	<link href="/theme/pygments.css" rel="stylesheet">

	<!-- Feeds -->




<script>var _gaq=[['_setAccount','UA-67731319-2'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="/">Michy's website</a>
			<ul class="nav">
					<li><a href="/pages/about-me.html">About me</a></li>
					<li><a href="/pages/projects.html">Projects</a></li>
					<li><a href="/pages/areas-of-expertise.html">Expertise</a></li>
					<li><a href="/pages/contacts.html">Contacts</a></li>
					<li><a href="/pages/resources.html">Resources</a></li>
					<li class="active"><a href="/category/posts.html">Posts</a></li>
			</ul>
			<p class="pull-right"><a href="/archives.html">[archives]</a> <a href="/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="http://firsttimeprogrammer.blogspot.com/">The Beginner Programmer</a></li>
				<li><a href="http://datascienceplus.com/author/mic/">Datascience+</a></li>
				<li><a href="http://www.r-bloggers.com/author/michy-alice/">R-Bloggers</a></li>
				<li><a href="http://www.milanor.net/blog/">MilanoR</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="http://twitter.com/mich9222">Twitter</a></li>
				<li><a href="http://github.com/mick001">Github</a></li>
				<li><a href="https://it.linkedin.com/in/michy-alice-3a5061a2">Linkedin</a></li>
				<li><a href="http://https://www.youtube.com/channel/UCMPULuD3KqiyH8Ysoj-1Hdg">Youtube</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Solving electrical radial lines with Python</h1></div>
		<div class="well small">Permalink: <a class="more" href="/solving-electrical-radial-lines-with-python.html">2016-12-10 08:00:00+00:00</a>
by <a class="url fn" href="/author/michy-alice.html">Michy Alice </a>
 in <a href="/category/posts.html">Posts</a>
tags: <a href="/tag/electrical-engineering.html">Electrical Engineering</a> <a href="/tag/python.html">Python</a> </div>
		<div><p>Electrical transmission systems are something we all take for granted. They work in a reliable manner ensuring high quality of service and as few minutes lost per year as possible.</p>
<p>Low voltage lines and most of medium voltage lines are radial lines, that is they are like a branch of a tree with a unique power supply location. Radial lines are relatively easy to work with, you can solve a radial line problem (ie you can get currents and voltages) by applying Boucherot’s theorem to each section of the line. This is a good news for a Python enthusiast as myself, since repetitive tasks lends themselves to be automated with programming.</p>
<p>Since Boucherot’s theorem uses the absolute values of electrical quantities, it is useful when you are working with AC lines and you would like to know the magnitude (rms) of currents and voltages while at the same time you do not really care about the phase differences. The rms values are used, for instance, when you need to choose the protection systems to install and what kind of electrical wires to use.</p>
<p>Suppose you are given the following three phase balanced radial line:</p>
<p><img alt="Radial electrical line" src="/images/line.png" /></p>
<p>You can think of C1, C2 and C3 as industrial motors or any other kind of three phased balanced loads.</p>
<p>We can make the following assumptions:
- The system is 3 phase, symmetrical and balanced.
- The loads are R – L loads (most loads are Ohmic inductive loads).
- The lines capacity can be neglected (this assumption is reasonable for overhead medium power lines).
- The load at the end of the line is working at nominal voltage.</p>
<p>These assumptions are reasonable and they mostly hold since three phase systems are designed to be as symmetrical as possible.</p>
<p>Under these assumptions, the following python script applies Bocherot’s theorem to calculate voltage and current rms at each section of the line.</p>
<p>The script contains 3 classes one for each element:
1) Electric load class. This class models an electric RL load assuming that the load is operated at nominal voltage.
2) The transformer class models a real transformer.
3) The transmission line class models a typical short power line.</p>
<p>Once the classes have been written, a few lines are required for solving the problem. The results are shown in the plot below.</p>
<p><img alt="Output plot" src="/images/vplot.png" /></p>
<p>As expected the results show a voltage drop across all sections (typical for RL loads) and, lower current on the primary side of the transformer. This is to be expected due to the voltage/current relationship of the transformer. As a next step, we could proceed to choose the appropriate security sistems to install at the beginning of each line and the electrical wires. Maybe this could be the next step in this project.</p>
<p>The code I used is shown below. I tried to make it as modular as possible so that it could be applied to almost every radial line. You can add as many loads, transformers and transmission lines as you like and then compute the values for each section. Originally this is how I checked my assignments but I thought it could be an interesting mini-project to share. I feel like the code is pretty self explanatory but feel free to leave a comment if you are not sure on what the code is doing!</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;ggplot&quot;</span><span class="p">)</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Auxiliary functions</span>

<span class="c1"># Complex power</span>
<span class="k">def</span> <span class="nf">complex_power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Current</span>
<span class="k">def</span> <span class="nf">current</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">V</span><span class="p">)</span>

<span class="c1"># Voltage</span>
<span class="k">def</span> <span class="nf">voltage</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">I</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>

<span class="c1"># Power (3 phase)</span>
<span class="k">def</span> <span class="nf">power_3f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">I</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">I</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Vectorized version of round</span>
<span class="kp">round_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">vectorize</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># 3 phase electric load</span>

<span class="k">class</span> <span class="nc">electric_load</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pf</span><span class="p">,</span> <span class="n">Vn</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="c1"># Electric load</span>
        <span class="c1">#</span>
        <span class="c1"># Power factor pf</span>
        <span class="c1"># Nominal voltage Vn [V]</span>
        <span class="c1"># Apparent (or complex) power [VA]</span>
        <span class="c1"># Power [W]</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="n">S</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">P</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either S or P should be assigned a value...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">S</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">/</span><span class="n">pf</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">S</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">*</span><span class="n">pf</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pf</span> <span class="o">=</span> <span class="n">pf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">arccos</span><span class="p">(</span><span class="n">pf</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vn</span> <span class="o">=</span> <span class="n">Vn</span>

    <span class="k">def</span> <span class="nf">current_draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Get the current draw of the electric load</span>
        <span class="c1"># Output: I</span>
        <span class="c1">#</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vn</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_electric_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Return the load characteristics</span>
        <span class="c1">#        </span>
        <span class="c1"># Output: V,I,p,q</span>
        <span class="c1">#</span>
        <span class="n">p_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span>
        <span class="n">q_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span>        
        <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vn</span>
        <span class="n">I</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_draw</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">p_</span><span class="p">,</span> <span class="n">q_</span>

    <span class="k">def</span> <span class="nf">add_load_in_parallel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
        <span class="c1"># Add a load in parallel in a given line.</span>
        <span class="c1"># Get V,I,p,q at the top of the transmission line</span>
        <span class="c1">#</span>
        <span class="c1"># Input: p,q,V at the bottom of the line before the load</span>
        <span class="c1"># Output: V,I,p,q at the top of the line</span>
        <span class="c1">#        </span>
        <span class="n">p_</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span>
        <span class="n">q_</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span>
        <span class="kp">s_</span> <span class="o">=</span> <span class="n">complex_power</span><span class="p">(</span><span class="n">p_</span><span class="p">,</span> <span class="n">q_</span><span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">current</span><span class="p">(</span><span class="kp">s_</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">p_</span><span class="p">,</span> <span class="n">q_</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Transformer class</span>

<span class="k">class</span> <span class="nc">transformer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V1n</span><span class="p">,</span> <span class="n">V2n</span><span class="p">,</span> <span class="n">Sn</span><span class="p">,</span> <span class="n">vcc_pc</span><span class="p">):</span>
        <span class="c1"># Transfomer</span>
        <span class="c1">#</span>
        <span class="c1"># V1n = nominal voltage at primary [V]</span>
        <span class="c1"># V2n = nominal voltage at secondary [V]</span>
        <span class="c1"># Sn = nominal apparent power [VA]</span>
        <span class="c1"># vcc_pc = short circuit voltage [%]</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V1n</span> <span class="o">=</span> <span class="n">V1n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V2n</span> <span class="o">=</span> <span class="n">V2n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sn</span> <span class="o">=</span> <span class="n">Sn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">V1n</span><span class="o">/</span><span class="n">V2n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vcc_pc</span> <span class="o">=</span> <span class="n">vcc_pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rcc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Xcc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vcc_pc</span> <span class="o">*</span> <span class="n">V2n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">Sn</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">primary_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">I2</span><span class="p">):</span>
        <span class="c1"># Get the values at the primary side of the transfomer</span>
        <span class="c1">#</span>
        <span class="c1"># Input: p,q,I at the secondary side of the transfomer</span>
        <span class="c1"># Output: V,I,p,q at the primary side of the transfomer</span>
        <span class="c1">#        </span>
        <span class="n">p_</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">power_3f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Rcc</span><span class="p">,</span> <span class="n">I2</span><span class="p">)</span>
        <span class="n">q_</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="n">power_3f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Xcc</span><span class="p">,</span> <span class="n">I2</span><span class="p">)</span>
        <span class="kp">s_</span> <span class="o">=</span> <span class="n">complex_power</span><span class="p">(</span><span class="n">p_</span><span class="p">,</span> <span class="n">q_</span><span class="p">)</span>
        <span class="n">V2</span> <span class="o">=</span> <span class="n">voltage</span><span class="p">(</span><span class="kp">s_</span><span class="p">,</span> <span class="n">I2</span><span class="p">)</span>
        <span class="n">V1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">*</span> <span class="n">V2</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="n">I2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="k">return</span> <span class="n">V1</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">p_</span><span class="p">,</span> <span class="n">q_</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Transmission line class</span>
<span class="k">class</span> <span class="nc">transmission_line</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
        <span class="c1"># Transmission line</span>
        <span class="c1"># </span>
        <span class="c1"># R = resistance [Ohm/km]</span>
        <span class="c1"># X = reactance [Ohm/km]</span>
        <span class="c1"># L = length [km]</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#self.Z_cmp = R + 1j * X</span>


    <span class="k">def</span> <span class="nf">same_current</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">I</span><span class="p">):</span>
        <span class="c1"># Get V,I,p,q at the top of the transmission line</span>
        <span class="c1">#</span>
        <span class="c1"># Input: p,q,I at the bottom of the line</span>
        <span class="c1"># Output: V,I,p,q at the top of the line</span>
        <span class="c1">#</span>
        <span class="n">p_</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">power_3f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
        <span class="n">q_</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="n">power_3f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
        <span class="kp">s_</span> <span class="o">=</span> <span class="n">complex_power</span><span class="p">(</span><span class="n">p_</span><span class="p">,</span> <span class="n">q_</span><span class="p">)</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">voltage</span><span class="p">(</span><span class="kp">s_</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">p_</span><span class="p">,</span> <span class="n">q_</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Example of application</span>

<span class="c1"># Loads</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">electric_load</span><span class="p">(</span><span class="n">pf</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span> <span class="n">Vn</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">electric_load</span><span class="p">(</span><span class="n">pf</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span> <span class="n">Vn</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>
<span class="n">c3</span> <span class="o">=</span> <span class="n">electric_load</span><span class="p">(</span><span class="n">pf</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">Vn</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="mi">2000000</span><span class="p">)</span>

<span class="c1"># Transmission lines</span>
<span class="n">tl_2</span> <span class="o">=</span> <span class="n">transmission_line</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">tl_1</span> <span class="o">=</span> <span class="n">transmission_line</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Transformers</span>
<span class="n">T_1</span> <span class="o">=</span> <span class="n">transformer</span><span class="p">(</span><span class="n">V1n</span><span class="o">=</span><span class="mi">132000</span><span class="p">,</span> <span class="n">V2n</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">Sn</span><span class="o">=</span><span class="mi">25000000</span><span class="p">,</span> <span class="n">vcc_pc</span><span class="o">=</span><span class="mf">12.5</span><span class="p">)</span>

<span class="c1"># Solve transmission line</span>
<span class="n">Va</span><span class="p">,</span> <span class="n">Ia</span><span class="p">,</span> <span class="n">Pa</span><span class="p">,</span> <span class="n">Qa</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">get_electric_load</span><span class="p">()</span>
<span class="n">Vb</span><span class="p">,</span> <span class="n">Ib</span><span class="p">,</span> <span class="n">Pb</span><span class="p">,</span> <span class="n">Qb</span> <span class="o">=</span> <span class="n">tl_2</span><span class="o">.</span><span class="n">same_current</span><span class="p">(</span><span class="n">Pa</span><span class="p">,</span> <span class="n">Qa</span><span class="p">,</span> <span class="n">Ia</span><span class="p">)</span>
<span class="n">Vb</span><span class="p">,</span> <span class="n">Ib</span><span class="p">,</span> <span class="n">Pb</span><span class="p">,</span> <span class="n">Qb</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">add_load_in_parallel</span><span class="p">(</span><span class="n">Pb</span><span class="p">,</span> <span class="n">Qb</span><span class="p">,</span> <span class="n">Vb</span><span class="p">)</span>
<span class="n">Vb</span><span class="p">,</span> <span class="n">Ib</span><span class="p">,</span> <span class="n">Pb</span><span class="p">,</span> <span class="n">Qb</span> <span class="o">=</span> <span class="n">c3</span><span class="o">.</span><span class="n">add_load_in_parallel</span><span class="p">(</span><span class="n">Pb</span><span class="p">,</span> <span class="n">Qb</span><span class="p">,</span> <span class="n">Vb</span><span class="p">)</span>
<span class="n">Vc</span><span class="p">,</span> <span class="n">Ic</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Qc</span> <span class="o">=</span> <span class="n">tl_1</span><span class="o">.</span><span class="n">same_current</span><span class="p">(</span><span class="n">Pb</span><span class="p">,</span> <span class="n">Qb</span><span class="p">,</span> <span class="n">Ib</span><span class="p">)</span>
<span class="n">Vd</span><span class="p">,</span> <span class="n">Id</span><span class="p">,</span> <span class="n">Pd</span><span class="p">,</span> <span class="n">Qd</span> <span class="o">=</span> <span class="n">T_1</span><span class="o">.</span><span class="n">primary_values</span><span class="p">(</span><span class="n">Pc</span><span class="p">,</span> <span class="n">Qc</span><span class="p">,</span> <span class="n">Ic</span><span class="p">)</span>

<span class="c1"># Get ready for printing out results</span>
<span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]</span>
<span class="n">V</span> <span class="o">=</span> <span class="kp">round_</span><span class="p">([</span><span class="n">Va</span><span class="p">,</span> <span class="n">Vb</span><span class="p">,</span> <span class="n">Vc</span><span class="p">,</span> <span class="n">Vd</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="kp">round_</span><span class="p">([</span><span class="n">Ia</span><span class="p">,</span> <span class="n">Ib</span><span class="p">,</span> <span class="n">Ic</span><span class="p">,</span> <span class="n">Id</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">dV_</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Vdc&quot;</span><span class="p">,</span> <span class="s2">&quot;Vcb&quot;</span><span class="p">,</span> <span class="s2">&quot;Vba&quot;</span><span class="p">]</span>
<span class="n">dV</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vd</span><span class="o">/</span><span class="mi">132000</span> <span class="o">-</span> <span class="n">Vc</span><span class="o">/</span><span class="mi">15000</span><span class="p">,</span> <span class="n">Vc</span><span class="o">/</span><span class="mi">15000</span> <span class="o">-</span> <span class="n">Vb</span><span class="o">/</span><span class="mi">15000</span><span class="p">,</span> <span class="n">Vb</span><span class="o">/</span><span class="mi">15000</span> <span class="o">-</span> <span class="n">Va</span><span class="o">/</span><span class="mi">15000</span><span class="p">]</span>
<span class="n">dV</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dV</span><span class="p">]</span>

<span class="c1"># Print results</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Section&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Voltage [kV]&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Current [A]&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sections</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Voltage drop:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dV_</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dV</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>

<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Current [A]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sections</span><span class="p">)),</span> <span class="n">sections</span><span class="p">,</span> <span class="kp">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sections</span><span class="p">)),</span> <span class="n">sections</span><span class="p">,</span> <span class="kp">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Voltage [kV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dV</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dV_</span><span class="p">)),</span> <span class="n">dV_</span><span class="p">,</span> <span class="kp">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Voltage drop %&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">################################################################################</span>
<span class="c1">#                       OUTPUT</span>
<span class="c1">################################################################################</span>
<span class="c1">#</span>
<span class="c1">#Section    Voltage [kV]    Current [A]</span>
<span class="c1">#a      15.0        42.77</span>
<span class="c1">#b      15.1        157.12</span>
<span class="c1">#c      15.28       157.12</span>
<span class="c1">#d      135.48      17.85</span>
<span class="c1">#</span>
<span class="c1">#Voltage drop:</span>
<span class="c1">#Vdc    0.8%</span>
<span class="c1">#Vcb    1.18%</span>
<span class="c1">#Vba    0.66%</span>
<span class="c1">#&gt;&gt;&gt;</span>
</pre></div></div>
	</div>
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; Michy Alice</p>
		</footer>
	  </div>

	</div>
</body>
</html>